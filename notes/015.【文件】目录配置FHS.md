> FHS = Filesystem Hierarchy Standard 文件系统层次结构标准

# 目录的4种交互形态
### 可分享的
- 可以分享给其他系统挂载使用的目录，所以包括执行文件与用户的邮件等数据，是能够分享给网络上其他主机挂载用的目录。

### 不可分享的
- 自己机器上面运行的设备文件或者是与程序有关的socket文件等，由于仅与自身机器有关，所以不可分享给其他主机。

### 不变的
- 有些数据是不会经常变动的
- e.g. 函数库、文件说明文档、系统管理员所管理的主机服务配置文件等

### 可变动的
- 经常改变的数据
- e.g. 登录文件、一般用户可自行接收的新闻群组等

![[img/015.目录的4中交互形态.png]]

# FHS 针对目录树架构定义出的三层目录
- `/` root，根目录：与开机系统有关
- `/usr` unix software resource：与软件安装/执行有关
- `/var` variable：与系统运行过程有关

### 根目录
- 所有目录都是由根目录衍生出来的
- 根目录也与开机/还原/系统修复等动作有关
- 根目录所在分区应该越小越好，用以保证性能
- 应用程序所安装的软件最好不要与根目录放在同一个分区内，保证根目录所在的文件系统不容易发生问题


# 详细目录配置
### 第一部分：FHS要求必须要存在的目录

| 目录       | 应放置文件内容                                                                                                                                                                                                                                                                                                                                                     | 备注                                                                                                                |
| -------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- |
| `/bin`   | - 放在`/bin`目录下的指令是在单人维护模式下还能够被操作的指令<br>- 在`/bin`下面的指令可以被root与一般账号使用，主要有：<br>	- `cat`<br>	- `chmod`<br>	- `chown`<br>	- `date`<br>	- `mv`<br>	- `mkdir`<br>	- `cp`<br>	- `bash`                                                                                                                                                                               | - 单人模式 (Single User Mode) - 指系统启动进入的一种特殊模式，在此模式下，只有root用户可以登录，并且系统只运行最基本的进程和服务。这种模式通常用于修复系统、更改配置或执行其他需要独占系统资源的任务。 |
| `/boot`  | - 主要放置开机会用到的文件，包括<br>	- Linux核心文件，Linux kernel 常用文件名为vmlinuz<br>	- 开机菜单与开机所需配置文件<br>	- 如果开机管理程序用的是grub2，还会存在/boot/grub2/这个目录<br>	- etc                                                                                                                                                                                                                      |                                                                                                                   |
| `/dev`   | - 设备与周边设备都是以文件的形态存在于`/dev`中的。<br>- 比较重要的文件：<br>	- `/dev/null`<br>	- `/dev/zero`<br>	- `/dev/tty`<br>	- `/dev/loop`<br>	- `/dev/sd`                                                                                                                                                                                                                          |                                                                                                                   |
| `/etc`   | - 放置系统的主要配置文件<br>- 一般来说，这个目录下的文件属性应该是可以让一般用户查阅的，但是只有root有权利修改。<br>- FHS建议不要放置可执行文件在这个目录中。<br>- 比较重要的文件：<br>	- `/etc/modprobe.d/`<br>	- `/etc/passwd`<br>	- `/etc/fstab`<br>	- `/etc/issue`<br>- 比较重要的目录：<br>	- `/etc/opt`：放置第三方软件`/opt`的相关配置文件<br>	- `/etc/X11/`：与 X Window 有关的各种配置文件<br>	- `/etc/sgml/`：与SGML格式有关的各项配置文件<br>	- `/etc/xml/`：与XML格式有关的各项配置文件 |                                                                                                                   |
| `/lib`   | - 放置在开机时会用到的函数库<br>- 放置在`/bin`或`/sbin`下的指令会调用的函数库<br>- FHS要求`/lib`下面的目录必须要存在`/lib/modules/`，这个目录主要放置可抽换式核心相关模块（驱动程序）                                                                                                                                                                                                                                        |                                                                                                                   |
| `/media` | - 可移除设备<br>- e.g. 软盘、光盘、DVD等设备都暂时挂载在这个目录下<br>- 常见文件名：<br>	- `/media/floppy`<br>	- `/media/cdrom`                                                                                                                                                                                                                                                            |                                                                                                                   |
| `/mnt`   | - 用来暂时挂载某些额外设备<br>- 在古早的时候，这个目录的用途与`/media`相同，有了`/media`之后，这个目录就用来暂时挂载用了。                                                                                                                                                                                                                                                                                   |                                                                                                                   |
| `/opt`   | - 放置第三方软件<br>- 在以前的Linux系统中，大家习惯放在/usr/local目录下                                                                                                                                                                                                                                                                                                             |                                                                                                                   |
| `/run`   | - 早期的FHS规定系统开机后产生的各项信息要放到`\var\run`目录下，新版的放到`/run`下面<br>- 由于`/run`可以使用内存来仿真，因此性能上会好很多                                                                                                                                                                                                                                                                       |                                                                                                                   |
| `/sbin`  | - 放置用来设置系统环境的指令<br>- 这些指令只有root才能使用来设置系统<br>- 其他用户只能用来查询<br>- `/sbin`：开机过程中所需要的，里面包括了开机、修复、还原系统所需要的指令。<br>- `/usr/sbin`：某些服务器软件程序<br>- `/usr/local/sbin/`：本机自行安装的软件所产生的系统可执行文件 (system binary)<br>- 常见的指令包括：<br>	- `fdisk`<br>	- `fsck`<br>	- `ifconfig`<br>	- `mkfs`                                                                                       |                                                                                                                   |
| `/srv`   | - service的缩写<br>- 是一些网络服务启动之后，这些服务所需要取用的数据目录<br>- e.g.<br>	- WWW - WWW服务器需要的网页数据就可以放置在`/svr/www/`里面<br>- 系统的服务数据如果尚未要提供给网络上的别人浏览的话，默认还是建议放置到/var/lib下面                                                                                                                                                                                                      |                                                                                                                   |
| `/tmp`   | - 普通用户或者正在执行的程序暂时放置文件的地方<br>- 这个目录是任何人都能够存取的，所以需要定期清理<br>- 重要的数据不可以放在这个目录！！！<br>- FHS甚至建议在开机时，应该要将`/tmp`下的数据都删除                                                                                                                                                                                                                                             |                                                                                                                   |
| `/usr`   |                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                   |
| `/var`   | - 主要放置变动性的数据                                                                                                                                                                                                                                                                                                                                                |                                                                                                                   |


### 第二部分：FHS建议可以存在的目录

| 目录           | 应放置文件内容                                                                                      | 备注                                                                 |
| ------------ | -------------------------------------------------------------------------------------------- | ------------------------------------------------------------------ |
| `/home`      | - 系统默认的使用者主文件夹 (home directory) <br>- 主文件夹有两种代号：<br>	- `~`<br>	- `/home/msty/`               |                                                                    |
| `/lib<qual>` | - 用来存放与`/lib`不同格式的二进制函数库<br>- e.g. 64位的`/lib64`函数库等                                          | - `<qual>`实际上是一个占位符，代表了可能出现在`/lib`之后的子目录名称。这些目录名称通常是用于进一步分类和组织库文件的 |
| `/root`      | - 系统管理员root的主文件夹。<br>- 如果进入担任维护模式而仅挂载根目录时，该目录能够拥有root的主文件夹，所以我们希望root的主文件夹与根目录放置在同一个分区中。<br> |                                                                    |

### 不在FHS标准中，但很重要的目录

| 目录            | 应放置文件内容                                                                                                                                                                                                                                                |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `/lost+found` | - 使用标准的ext2/ext3/ext4文件系统格式才会产生的一个目录<br>- 目的在于当文件系统发生错误时，将一些遗失的片段放置到这个目录下<br>- 如果使用的是xfs文件系统的话，就不会存在这个目录了                                                                                                                                              |
| `/proc`       | - 这个目录本身是一个“虚拟文件系统 (virtual filesystem)”<br>- 数据都在内存中，本身不占硬盘空间<br>- e.g. <br>	- 系统核心<br>	- process信息<br>	- 周边设备的状态<br>	- 网络状态<br>- 比较重要的文件：<br>	- `/proc/cpuinfo`<br>	- `/proc/dma`<br>	- `/proc/interrupts`<br>	- `/proc/ioports`<br>	- `/proc/net/*` |
| `/sys`        | - 也是一个虚拟文件系统<br>- 主要也是记录核心与系统硬件信息较相关的信息<br>- 包括：<br>	- 目前已载入的核心模块<br>	- 核心侦测到的硬件设备信息<br>- 这个设备同样不占硬盘容量<br>                                                                                                                                             |

##### 救援模式
- 救援模式通常只挂载根目录
- 因此有5个重要的目录被要求一定要与根目录放在一起：
	- `/etc`
	- `/bin`
	- `/dev`
	- `/lib`
	- `/sbin`
	- 现在许多非必要文件移出`/usr`之外了，所以`usr`被建议为“及时挂载为只读，系统还是可以正常运行”，所以救援模式也能同时挂载`/usr`

# /usr
- 可分享的 shareable
- 不可变动的 static
- 全称：Unix Software Resource (Unix操作系统软件资源)
- 是放置操作系统软件资源的目录，而不是使用者的数据
- FHS建议：将数据合理的分别放置到这个目录下的次目录，而不是自行创建该软件自己独立的目录
- 所有系统默认的软件(distribution发布者提供的软件)都会放在/usr下面，因此这个目录有点类似Windows系统的`C:\WWindows(其中的一部分)+C:\Program files\`这两个目录的综合体。
- 安装时会占用较大硬盘容量

### /usr次目录建议

##### FHS要求必须存在的目录

| 目录            | 应放置的文件内容                                                                                                                                              |
| ------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
| `/usr/bin/`   | - 普通用户能够使用的指令<br>- CentOS 7 已经将全部的使用者指令放在这里，且使用链接文件的方式将/bin链接到这里。（=> `/usr/bin`与`/bin`一样了）<br>- FHS要求此目录下不应有子目录                                       |
| `/usr/lib/`   | - 与`/lib`功能相同，`/lib`就是链接到此目录中的                                                                                                                        |
| `/usr/local/` | - 系统管理员在本机自行安装自己下载的软件（非distribution默认提供者）<br>- 当distribution官方提供的软件版本较旧而又需要新版软件时，可以将新版软件安装到此目录下，与旧版软件并存                                               |
| `/usr/sbin/`  | - 非系统正常运行所需的系统指令<br>- 最常见就是某些网络服务器软件的服务指令(daemon)<br>- `/sbin`是链接到此目录的，所以基本功能差不多                                                                      |
| `/usr/share/` | - 只读架构的数据文件，e.g. 共享文件<br>- 这里的数据部分硬件架构<br>- 常见次目录<br>	- `/usr/share/man` 线上说明文档<br>	- `/usr/share/doc` 软件杂项的文件说明<br>	- `/usr/share/zoneinfo` 与时区有关的文件 |

##### FHS建议可以存在的目录

| 目录                | 应放置的文件内容                                            |
| ----------------- | --------------------------------------------------- |
| `/usr/games/`     | - 与游戏相关的文件                                          |
| `/usr/include/`   | - C/C++等程序语言的header / include等                      |
| `/usr/libexec`    | - 一些不被普通用户常用的可执行文件或脚本<br>- e.g. 大部分 X Window 下的操作指令 |
| `/usr/lib<qual>/` | - 与`/lib<qual>/`功能相同，同样是链接                          |
| `/usr/src/`       | - 一般源代码建议放在这里<br>- 核心源代码建议放在`/usr/src/linux`目录下     |

# /var
- 主要针对常态性变动的文件，包括
	- 高速缓存 (cache)
	- 登录文件 (log file)
	- 某些软件运行所产生的文件 (lock file, run file)
- 在系统运行后会渐渐占用硬盘容量

##### FHS要求必须存在的目录

| 目录            | 应放置文件内容                                                                                              |
| ------------- | ---------------------------------------------------------------------------------------------------- |
| `/var/cache/` | - 应用程序本身运行过程中会产生的一些暂存盘                                                                               |
| `/var/lock/`  | - 某些设备或文件资源一次只能被一个应用程序使用。当两个程序同时需要使用该文件时，需要将该文件上锁 (lock)，以确保该设备只会给单一程序使用。<br>- 目前此目录已经挪到`/run/lock`中 |
| `/var/log/`   | - 登录文件放置的目录<br>- 比较重要的文件<br>	- `/var/log/messages`<br>	- `/var/log/wtmp` 记录登陆者的信息                    |
| `/var/mail/`  | - 放个人电子邮箱<br>- 与`/var/spool/mail/`目录互为链接                                                             |
| `/var/run/`   | - 某些程序或服务启动后，将PID放到该目录<br>- 已经链接到`/run`                                                              |
| `/var/spool/` | - 放一些队列数据（队列数据是指排队等待其他程序使用的数据）<br>- 这些数据被使用后通常会被删除<br>- 如果是工作调度数据 (crontab)，会被放到`/var/spool/cron/`下  |


